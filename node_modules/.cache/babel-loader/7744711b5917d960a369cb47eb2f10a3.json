{"ast":null,"code":"import { createAction, handleActions } from 'redux-actions';\nimport { takeLatest, call } from 'redux-saga/effects';\nimport * as authAPI from '../lib/api/auth';\nimport * as chatHallAPI from '../lib/api/chatHall';\nimport createRequestSaga, { createRequestActionTypes } from '../lib/createRequestSaga';\nconst [CHECK, CHECK_SUCCESS, CHECK_FAILURE] = createRequestActionTypes('user/CHECK');\nconst [ACCESS_CHAT_HALL, ACCESS_CHAT_HALL_SUCCESS, ACCESS_CHAT_HALL_FAILURE] = createRequestActionTypes('user/ACCESS_CHAT_HALL');\nconst [GET_GUEST_NUMBER, GET_GUEST_NUMBER_SUCCESS, GET_GUEST_NUMBER_FAILURE] = createRequestActionTypes('user/GET_GUEST_NUMBER');\nconst LOGOUT = 'user/LOGOUT';\nconst TEMP_SET_USER = 'user/TEMP_SET_USER';\nexport const tempSetUser = createAction(TEMP_SET_USER);\nexport const check = createAction(CHECK);\nexport const logout = createAction(LOGOUT);\nexport const accessChatHall = createAction(ACCESS_CHAT_HALL);\nexport const getGuestNumber = createAction(GET_GUEST_NUMBER);\nconst checkSaga = createRequestSaga(CHECK, authAPI.check);\nconst accessChatHallSaga = createRequestSaga(ACCESS_CHAT_HALL, chatHallAPI.access);\nconst getGuestNumberSaga = createRequestSaga(GET_GUEST_NUMBER, chatHallAPI.guestNumber);\n\nfunction checkFailureSaga() {\n  try {\n    localStorage.removeItem('user');\n  } catch (e) {\n    console.log('localStorage is not working');\n  }\n}\n\nfunction* logoutSaga() {\n  console.log('in logoutSaga');\n\n  try {\n    yield call(authAPI.logout);\n    localStorage.removeItem('user');\n  } catch (e) {\n    console.log(e);\n  }\n}\n\nexport function* userSaga() {\n  yield takeLatest(CHECK, checkSaga);\n  yield takeLatest(CHECK_FAILURE, checkFailureSaga);\n  yield takeLatest(LOGOUT, logoutSaga);\n  yield takeLatest(ACCESS_CHAT_HALL, accessChatHallSaga);\n  yield takeLatest(GET_GUEST_NUMBER, getGuestNumberSaga);\n}\nconst initialState = {\n  user: null,\n  chatHallUserList: null,\n  checkError: null\n};\nexport default handleActions({\n  [CHECK_SUCCESS]: (state, _ref) => {\n    let {\n      payload: user\n    } = _ref;\n    return { ...state,\n      user,\n      checkError: null\n    };\n  },\n  [CHECK_FAILURE]: (state, _ref2) => {\n    let {\n      payload: error\n    } = _ref2;\n    return { ...state,\n      user: null,\n      checkError: error\n    };\n  },\n  [LOGOUT]: state => ({ ...state,\n    user: null\n  }),\n  [TEMP_SET_USER]: (state, _ref3) => {\n    let {\n      payload: user\n    } = _ref3;\n    return { ...state,\n      user: user\n    };\n  },\n  [ACCESS_CHAT_HALL_SUCCESS]: (state, action) => {\n    console.log(action);\n    return { ...state\n    };\n  },\n  [ACCESS_CHAT_HALL_FAILURE]: (state, _ref4) => {\n    let {\n      payload: error\n    } = _ref4;\n    return { ...state,\n      user: null,\n      checkError: error\n    };\n  },\n  [GET_GUEST_NUMBER_SUCCESS]: (state, _ref5) => {\n    let {\n      payload: guestInfo\n    } = _ref5;\n    return { ...state,\n      uesr: {\n        username: guestInfo,\n        nickname: guestInfo,\n        profileImage: null\n      }\n    };\n  }\n}, initialState);","map":{"version":3,"sources":["C:/nani/connect/connect-frontend/src/modules/user.js"],"names":["createAction","handleActions","takeLatest","call","authAPI","chatHallAPI","createRequestSaga","createRequestActionTypes","CHECK","CHECK_SUCCESS","CHECK_FAILURE","ACCESS_CHAT_HALL","ACCESS_CHAT_HALL_SUCCESS","ACCESS_CHAT_HALL_FAILURE","GET_GUEST_NUMBER","GET_GUEST_NUMBER_SUCCESS","GET_GUEST_NUMBER_FAILURE","LOGOUT","TEMP_SET_USER","tempSetUser","check","logout","accessChatHall","getGuestNumber","checkSaga","accessChatHallSaga","access","getGuestNumberSaga","guestNumber","checkFailureSaga","localStorage","removeItem","e","console","log","logoutSaga","userSaga","initialState","user","chatHallUserList","checkError","state","payload","error","action","guestInfo","uesr","username","nickname","profileImage"],"mappings":"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","sourcesContent":["import { createAction, handleActions } from 'redux-actions';\r\nimport { takeLatest, call } from 'redux-saga/effects';\r\nimport * as authAPI from '../lib/api/auth';\r\nimport * as chatHallAPI from '../lib/api/chatHall';\r\n\r\nimport createRequestSaga, {\r\n  createRequestActionTypes,\r\n} from '../lib/createRequestSaga';\r\n\r\nconst [CHECK, CHECK_SUCCESS, CHECK_FAILURE] =\r\n  createRequestActionTypes('user/CHECK');\r\n\r\nconst [ACCESS_CHAT_HALL, ACCESS_CHAT_HALL_SUCCESS, ACCESS_CHAT_HALL_FAILURE] =\r\n  createRequestActionTypes('user/ACCESS_CHAT_HALL');\r\n\r\nconst [GET_GUEST_NUMBER, GET_GUEST_NUMBER_SUCCESS, GET_GUEST_NUMBER_FAILURE] =\r\n  createRequestActionTypes('user/GET_GUEST_NUMBER');\r\n\r\nconst LOGOUT = 'user/LOGOUT';\r\nconst TEMP_SET_USER = 'user/TEMP_SET_USER';\r\n\r\nexport const tempSetUser = createAction(TEMP_SET_USER);\r\nexport const check = createAction(CHECK);\r\nexport const logout = createAction(LOGOUT);\r\nexport const accessChatHall = createAction(ACCESS_CHAT_HALL);\r\nexport const getGuestNumber = createAction(GET_GUEST_NUMBER);\r\n\r\nconst checkSaga = createRequestSaga(CHECK, authAPI.check);\r\nconst accessChatHallSaga = createRequestSaga(\r\n  ACCESS_CHAT_HALL,\r\n  chatHallAPI.access,\r\n);\r\nconst getGuestNumberSaga = createRequestSaga(\r\n  GET_GUEST_NUMBER,\r\n  chatHallAPI.guestNumber,\r\n);\r\n\r\nfunction checkFailureSaga() {\r\n  try {\r\n    localStorage.removeItem('user');\r\n  } catch (e) {\r\n    console.log('localStorage is not working');\r\n  }\r\n}\r\n\r\nfunction* logoutSaga() {\r\n  console.log('in logoutSaga');\r\n  try {\r\n    yield call(authAPI.logout);\r\n    localStorage.removeItem('user');\r\n  } catch (e) {\r\n    console.log(e);\r\n  }\r\n}\r\n\r\nexport function* userSaga() {\r\n  yield takeLatest(CHECK, checkSaga);\r\n  yield takeLatest(CHECK_FAILURE, checkFailureSaga);\r\n  yield takeLatest(LOGOUT, logoutSaga);\r\n  yield takeLatest(ACCESS_CHAT_HALL, accessChatHallSaga);\r\n  yield takeLatest(GET_GUEST_NUMBER, getGuestNumberSaga);\r\n}\r\n\r\nconst initialState = {\r\n  user: null,\r\n  chatHallUserList: null,\r\n  checkError: null,\r\n};\r\n\r\nexport default handleActions(\r\n  {\r\n    [CHECK_SUCCESS]: (state, { payload: user }) => ({\r\n      ...state,\r\n      user,\r\n      checkError: null,\r\n    }),\r\n    [CHECK_FAILURE]: (state, { payload: error }) => ({\r\n      ...state,\r\n      user: null,\r\n      checkError: error,\r\n    }),\r\n    [LOGOUT]: (state) => ({\r\n      ...state,\r\n      user: null,\r\n    }),\r\n    [TEMP_SET_USER]: (state, { payload: user }) => ({\r\n      ...state,\r\n      user: user,\r\n    }),\r\n    [ACCESS_CHAT_HALL_SUCCESS]: (state, action) => {\r\n      console.log(action);\r\n      return { ...state };\r\n    },\r\n    [ACCESS_CHAT_HALL_FAILURE]: (state, { payload: error }) => ({\r\n      ...state,\r\n      user: null,\r\n      checkError: error,\r\n    }),\r\n    [GET_GUEST_NUMBER_SUCCESS]: (state, { payload: guestInfo }) => ({\r\n      ...state,\r\n      uesr: {\r\n        username: guestInfo,\r\n        nickname: guestInfo,\r\n        profileImage: null,\r\n      },\r\n    }),\r\n  },\r\n  initialState,\r\n);\r\n"]},"metadata":{},"sourceType":"module"}