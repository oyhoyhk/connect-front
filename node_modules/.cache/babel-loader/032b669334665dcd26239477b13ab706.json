{"ast":null,"code":"import _slicedToArray from\"C:/nani/connect/connect-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{useDispatch,useSelector}from'react-redux';import ProfileSettingForm from'../../components/auth/ProfileSettingForm';import{initializeForm,register}from'../../modules/auth';import imageCompression from'../../../node_modules/browser-image-compression/dist/browser-image-compression';import{useNavigate}from'../../../node_modules/react-router/index';import{check}from'../../modules/user';import{jsx as _jsx}from\"react/jsx-runtime\";var ProfileSettingContainer=function ProfileSettingContainer(){var dispatch=useDispatch();var navigate=useNavigate();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),profileImage=_useState2[0],setProfileImage=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),nickname=_useState4[0],setNickname=_useState4[1];var _useSelector=useSelector(function(_ref){var _ref$auth=_ref.auth,tempInfo=_ref$auth.tempInfo,auth=_ref$auth.auth,user=_ref.user;return{username:tempInfo.username,password:tempInfo.password,auth:auth,user:user.user};}),username=_useSelector.username,password=_useSelector.password,auth=_useSelector.auth,user=_useSelector.user;var onChange=function onChange(e,ref){if(e.target.files){var reader=new FileReader();reader.readAsDataURL(e.target.files[0]);reader.onload=function(event){ref.style.backgroundImage=\"url(\".concat(event.target.result,\")\");// setProfileImage(event.target.result.toString());\n};imageCompression(e.target.files[0]).then(function(res){return setProfileImage(res);});}else{setNickname(e.target.value);}};var onSubmit=function onSubmit(e){e.preventDefault();var formData=new FormData();formData.append('username',username);formData.append('password',password);formData.append('nickname',nickname);formData.append('profileImage',profileImage);dispatch(register(formData));};useEffect(function(){if(username===''){navigate(-1);}dispatch(initializeForm({username:username,password:password}));},[dispatch,password,username,navigate]);useEffect(function(){if(auth){console.log('회원 가입 성공, auth : ',auth);dispatch(check());}},[dispatch,auth]);useEffect(function(){if(user){dispatch(initializeForm('register'));localStorage.setItem('user',JSON.stringify(user));navigate('/friends');}},[navigate,user,dispatch]);return/*#__PURE__*/_jsx(ProfileSettingForm,{onChange:onChange,username:username,onSubmit:onSubmit});};export default ProfileSettingContainer;","map":{"version":3,"sources":["C:/nani/connect/connect-frontend/src/containers/auth/ProfileSettingContainer.js"],"names":["React","useEffect","useState","useDispatch","useSelector","ProfileSettingForm","initializeForm","register","imageCompression","useNavigate","check","ProfileSettingContainer","dispatch","navigate","profileImage","setProfileImage","nickname","setNickname","auth","tempInfo","user","username","password","onChange","e","ref","target","files","reader","FileReader","readAsDataURL","onload","event","style","backgroundImage","result","then","res","value","onSubmit","preventDefault","formData","FormData","append","console","log","localStorage","setItem","JSON","stringify"],"mappings":"sHAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,aAAzC,CACA,MAAOC,CAAAA,kBAAP,KAA+B,0CAA/B,CACA,OAASC,cAAT,CAAyBC,QAAzB,KAAyC,oBAAzC,CACA,MAAOC,CAAAA,gBAAP,KAA6B,gFAA7B,CACA,OAASC,WAAT,KAA4B,0CAA5B,CACA,OAASC,KAAT,KAAsB,oBAAtB,C,2CAEA,GAAMC,CAAAA,uBAAuB,CAAG,QAA1BA,CAAAA,uBAA0B,EAAM,CACpC,GAAMC,CAAAA,QAAQ,CAAGT,WAAW,EAA5B,CACA,GAAMU,CAAAA,QAAQ,CAAGJ,WAAW,EAA5B,CACA,cAAwCP,QAAQ,CAAC,IAAD,CAAhD,wCAAOY,YAAP,eAAqBC,eAArB,eACA,eAAgCb,QAAQ,CAAC,EAAD,CAAxC,yCAAOc,QAAP,eAAiBC,WAAjB,eACA,iBAA2Cb,WAAW,CACpD,kCAAGc,IAAH,CAAWC,QAAX,WAAWA,QAAX,CAAqBD,IAArB,WAAqBA,IAArB,CAA6BE,IAA7B,MAA6BA,IAA7B,OAAyC,CACvCC,QAAQ,CAAEF,QAAQ,CAACE,QADoB,CAEvCC,QAAQ,CAAEH,QAAQ,CAACG,QAFoB,CAGvCJ,IAAI,CAAJA,IAHuC,CAIvCE,IAAI,CAAEA,IAAI,CAACA,IAJ4B,CAAzC,EADoD,CAAtD,CAAQC,QAAR,cAAQA,QAAR,CAAkBC,QAAlB,cAAkBA,QAAlB,CAA4BJ,IAA5B,cAA4BA,IAA5B,CAAkCE,IAAlC,cAAkCA,IAAlC,CASA,GAAMG,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACC,CAAD,CAAIC,GAAJ,CAAY,CAC3B,GAAID,CAAC,CAACE,MAAF,CAASC,KAAb,CAAoB,CAClB,GAAMC,CAAAA,MAAM,CAAG,GAAIC,CAAAA,UAAJ,EAAf,CACAD,MAAM,CAACE,aAAP,CAAqBN,CAAC,CAACE,MAAF,CAASC,KAAT,CAAe,CAAf,CAArB,EACAC,MAAM,CAACG,MAAP,CAAgB,SAACC,KAAD,CAAW,CACzBP,GAAG,CAACQ,KAAJ,CAAUC,eAAV,eAAmCF,KAAK,CAACN,MAAN,CAAaS,MAAhD,MACA;AACD,CAHD,CAIA3B,gBAAgB,CAACgB,CAAC,CAACE,MAAF,CAASC,KAAT,CAAe,CAAf,CAAD,CAAhB,CAAoCS,IAApC,CAAyC,SAACC,GAAD,QAAStB,CAAAA,eAAe,CAACsB,GAAD,CAAxB,EAAzC,EACD,CARD,IAQO,CACLpB,WAAW,CAACO,CAAC,CAACE,MAAF,CAASY,KAAV,CAAX,CACD,CACF,CAZD,CAaA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACf,CAAD,CAAO,CACtBA,CAAC,CAACgB,cAAF,GACA,GAAMC,CAAAA,QAAQ,CAAG,GAAIC,CAAAA,QAAJ,EAAjB,CACAD,QAAQ,CAACE,MAAT,CAAgB,UAAhB,CAA4BtB,QAA5B,EACAoB,QAAQ,CAACE,MAAT,CAAgB,UAAhB,CAA4BrB,QAA5B,EACAmB,QAAQ,CAACE,MAAT,CAAgB,UAAhB,CAA4B3B,QAA5B,EACAyB,QAAQ,CAACE,MAAT,CAAgB,cAAhB,CAAgC7B,YAAhC,EACAF,QAAQ,CAACL,QAAQ,CAACkC,QAAD,CAAT,CAAR,CACD,CARD,CASAxC,SAAS,CAAC,UAAM,CACd,GAAIoB,QAAQ,GAAK,EAAjB,CAAqB,CACnBR,QAAQ,CAAC,CAAC,CAAF,CAAR,CACD,CACDD,QAAQ,CAACN,cAAc,CAAC,CAAEe,QAAQ,CAARA,QAAF,CAAYC,QAAQ,CAARA,QAAZ,CAAD,CAAf,CAAR,CACD,CALQ,CAKN,CAACV,QAAD,CAAWU,QAAX,CAAqBD,QAArB,CAA+BR,QAA/B,CALM,CAAT,CAOAZ,SAAS,CAAC,UAAM,CACd,GAAIiB,IAAJ,CAAU,CACR0B,OAAO,CAACC,GAAR,CAAY,mBAAZ,CAAiC3B,IAAjC,EACAN,QAAQ,CAACF,KAAK,EAAN,CAAR,CACD,CACF,CALQ,CAKN,CAACE,QAAD,CAAWM,IAAX,CALM,CAAT,CAOAjB,SAAS,CAAC,UAAM,CACd,GAAImB,IAAJ,CAAU,CACRR,QAAQ,CAACN,cAAc,CAAC,UAAD,CAAf,CAAR,CACAwC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAA6BC,IAAI,CAACC,SAAL,CAAe7B,IAAf,CAA7B,EACAP,QAAQ,CAAC,UAAD,CAAR,CACD,CACF,CANQ,CAMN,CAACA,QAAD,CAAWO,IAAX,CAAiBR,QAAjB,CANM,CAAT,CAOA,mBACE,KAAC,kBAAD,EACE,QAAQ,CAAEW,QADZ,CAEE,QAAQ,CAAEF,QAFZ,CAGE,QAAQ,CAAEkB,QAHZ,EADF,CAOD,CAhED,CAkEA,cAAe5B,CAAAA,uBAAf","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport ProfileSettingForm from '../../components/auth/ProfileSettingForm';\r\nimport { initializeForm, register } from '../../modules/auth';\r\nimport imageCompression from '../../../node_modules/browser-image-compression/dist/browser-image-compression';\r\nimport { useNavigate } from '../../../node_modules/react-router/index';\r\nimport { check } from '../../modules/user';\r\n\r\nconst ProfileSettingContainer = () => {\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate();\r\n  const [profileImage, setProfileImage] = useState(null);\r\n  const [nickname, setNickname] = useState('');\r\n  const { username, password, auth, user } = useSelector(\r\n    ({ auth: { tempInfo, auth }, user }) => ({\r\n      username: tempInfo.username,\r\n      password: tempInfo.password,\r\n      auth,\r\n      user: user.user,\r\n    }),\r\n  );\r\n\r\n  const onChange = (e, ref) => {\r\n    if (e.target.files) {\r\n      const reader = new FileReader();\r\n      reader.readAsDataURL(e.target.files[0]);\r\n      reader.onload = (event) => {\r\n        ref.style.backgroundImage = `url(${event.target.result})`;\r\n        // setProfileImage(event.target.result.toString());\r\n      };\r\n      imageCompression(e.target.files[0]).then((res) => setProfileImage(res));\r\n    } else {\r\n      setNickname(e.target.value);\r\n    }\r\n  };\r\n  const onSubmit = (e) => {\r\n    e.preventDefault();\r\n    const formData = new FormData();\r\n    formData.append('username', username);\r\n    formData.append('password', password);\r\n    formData.append('nickname', nickname);\r\n    formData.append('profileImage', profileImage);\r\n    dispatch(register(formData));\r\n  };\r\n  useEffect(() => {\r\n    if (username === '') {\r\n      navigate(-1);\r\n    }\r\n    dispatch(initializeForm({ username, password }));\r\n  }, [dispatch, password, username, navigate]);\r\n\r\n  useEffect(() => {\r\n    if (auth) {\r\n      console.log('회원 가입 성공, auth : ', auth);\r\n      dispatch(check());\r\n    }\r\n  }, [dispatch, auth]);\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      dispatch(initializeForm('register'));\r\n      localStorage.setItem('user', JSON.stringify(user));\r\n      navigate('/friends');\r\n    }\r\n  }, [navigate, user, dispatch]);\r\n  return (\r\n    <ProfileSettingForm\r\n      onChange={onChange}\r\n      username={username}\r\n      onSubmit={onSubmit}\r\n    />\r\n  );\r\n};\r\n\r\nexport default ProfileSettingContainer;\r\n"]},"metadata":{},"sourceType":"module"}